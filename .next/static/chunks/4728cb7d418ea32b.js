(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,91288,e=>{"use strict";var t=e.i(43476);let a=(0,e.i(75254).default)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),l={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg"};function s({isOpen:e,title:s,onClose:r,children:i,size:o="md"}){return e?(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4 py-8 bg-slate-950/60 backdrop-blur-sm sm-animate-overlay-in",children:(0,t.jsxs)("div",{className:`w-full ${l[o]} bg-white rounded-2xl border border-slate-200/80 card-shadow-lg overflow-hidden max-h-[90vh] flex flex-col sm-animate-modal-in`,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-200/80",children:[(0,t.jsx)("h2",{className:"text-base md:text-lg font-semibold text-slate-900",children:s}),(0,t.jsx)("button",{onClick:r,className:"inline-flex h-8 w-8 items-center justify-center rounded-full text-slate-400 hover:text-slate-900 hover:bg-slate-100 transition-colors",children:(0,t.jsx)(a,{className:"w-4 h-4"})})]}),(0,t.jsx)("div",{className:"px-6 py-5 overflow-y-auto",children:i})]})}):null}e.s(["Modal",()=>s],91288)},72161,e=>{"use strict";class t extends Error{status;data;constructor(e,t,a=null){super(e),this.name="ApiError",this.status=t,this.data=a}}async function a(e,l={}){let{method:s="GET",params:r,body:i,headers:o,signal:n}=l,d=function(e,t){let a=e.startsWith("http")?e:`http://localhost:8080/api${e}`;if(!t)return a;let l=new URL(a);return Object.entries(t).forEach(([e,t])=>{null!=t&&l.searchParams.append(e,String(t))}),l.toString()}(e,r),c={"Content-Type":"application/json",...o};try{let e=window.localStorage.getItem("authToken");e&&!c.Authorization&&(c={...c,Authorization:`Bearer ${e}`})}catch{}let m={method:s,headers:c,signal:n};if(null!=i&&"GET"!==s)if(i instanceof FormData){let{"Content-Type":e,...t}=c;m.headers=c=t,m.body=i}else m.body=JSON.stringify(i);let u=await fetch(d,m),x=await u.text(),h=null;if(x)try{h=JSON.parse(x)}catch{h=x}if(!u.ok)throw new t(u.statusText||"Request failed",u.status,h);return h}function l(e,t){return a(e,{...t,method:"GET"})}function s(e,t,l){return a(e,{...l,method:"POST",body:t})}e.s(["ApiError",()=>t,"get",()=>l,"post",()=>s])},8623,e=>{"use strict";var t=e.i(43476),a=e.i(71645);function l({columns:e,data:l,searchableFields:s=[],actions:r,renderCell:i,footerTotals:o}){let[n,d]=(0,a.useState)(""),[c,m]=(0,a.useState)(null),[u,x]=(0,a.useState)(1),h=l;s.length>0&&(h=l.filter(e=>s.some(t=>String(e[t]).toLowerCase().includes(n.toLowerCase())))),c&&(h=[...h].sort((e,t)=>{let a=e[c.key],l=t[c.key],s=a<l?-1:+(a>l);return"asc"===c.direction?s:-s}));let y=Math.ceil(h.length/10),b=h.slice((u-1)*10,10*u),p=o?h.reduce((e,t)=>(void 0!==t.quantity&&(e.quantity+=t.quantity),void 0!==t.totalSum&&(e.totalSum+=t.totalSum),void 0!==t.amount&&(e.amount+=t.amount),void 0!==t.total&&(e.total+=t.total),void 0!==t.advance&&(e.advance+=t.advance),void 0!==t.remaining&&(e.remaining+=t.remaining),void 0!==t.cost&&(e.cost+=t.cost),void 0!==t.count&&(e.count+=t.count),e),{quantity:0,totalSum:0,amount:0,total:0,advance:0,remaining:0,cost:0,count:h.length}):null;return(0,t.jsxs)("div",{className:"space-y-4",children:[s.length>0&&(0,t.jsx)("div",{className:"flex gap-4",children:(0,t.jsx)("input",{type:"text",placeholder:"Search...",value:n,onChange:e=>{d(e.target.value),x(1)},className:"flex-1 px-4 py-2 border border-slate-200 rounded-lg text-sm text-slate-700 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-[#2563EB]"})}),(0,t.jsx)("div",{className:"overflow-x-auto rounded-2xl border border-slate-100",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-slate-50 border-b border-slate-200",children:[e.map(e=>(0,t.jsx)("th",{className:"px-6 py-3 text-left",children:e.sortable?(0,t.jsxs)("button",{onClick:()=>{var t;return t=e.key,void(m(e=>e?.key===t&&"asc"===e.direction?{key:t,direction:"desc"}:{key:t,direction:"asc"}),x(1))},className:"flex items-center gap-2 font-semibold text-slate-700 hover:text-[#2563EB] transition-colors",children:[e.label,c?.key===e.key&&(0,t.jsx)("span",{children:"asc"===c.direction?"↑":"↓"})]}):(0,t.jsx)("span",{className:"font-semibold text-slate-700",children:e.label})},e.key)),r&&(0,t.jsx)("th",{className:"px-6 py-3 text-left font-semibold text-slate-700",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:b.map((a,l)=>(0,t.jsxs)("tr",{className:"border-b border-slate-100 hover:bg-slate-50 transition-colors",children:[e.map(e=>(0,t.jsx)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:i?i(a,e):a[e.key]},e.key)),r&&(0,t.jsx)("td",{className:"px-6 py-4",children:r(a)})]},l))}),p&&(0,t.jsx)("tfoot",{children:(0,t.jsxs)("tr",{className:"bg-slate-50 border-t border-slate-200 font-semibold",children:[e.map(a=>"quantity"===a.key&&void 0!==p.quantity?(0,t.jsxs)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:[new Intl.NumberFormat("ru-RU",{maximumFractionDigits:0}).format(p.quantity)," tonna"]},a.key):"cost"===a.key&&void 0!==p.cost?(0,t.jsx)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:new Intl.NumberFormat("ru-RU",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(p.cost)},a.key):"totalSum"===a.key&&void 0!==p.totalSum?(0,t.jsxs)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:[new Intl.NumberFormat("ru-RU",{maximumFractionDigits:0}).format(p.totalSum)," so'm"]},a.key):"amount"===a.key&&void 0!==p.amount?(0,t.jsx)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:new Intl.NumberFormat("ru-RU",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(p.amount)},a.key):"total"===a.key&&void 0!==p.total?(0,t.jsx)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:new Intl.NumberFormat("ru-RU",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(p.total)},a.key):"advance"===a.key&&void 0!==p.advance?(0,t.jsx)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:new Intl.NumberFormat("ru-RU",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(p.advance)},a.key):"remaining"===a.key&&void 0!==p.remaining?(0,t.jsx)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:new Intl.NumberFormat("ru-RU",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(p.remaining)},a.key):"batchId"===a.key||"id"===a.key?(0,t.jsx)("td",{className:"px-6 py-4 text-slate-900 text-right font-semibold text-sm",children:"Jami:"},a.key):("operator"!==a.key||void 0===p.count||!(p.count>0))&&("producedAt"!==a.key&&"loggedAt"!==a.key&&"payoutDate"!==a.key&&"date"!==a.key||void 0===p.count||!(p.count>0)||e.find(e=>"operator"===e.key))&&("status"!==a.key||void 0===p.count||!(p.count>0)||e.find(e=>"operator"===e.key)||e.find(e=>"producedAt"===e.key||"loggedAt"===e.key||"payoutDate"===e.key||"date"===e.key))&&("transport"!==a.key||void 0===p.count||!(p.count>0)||e.find(e=>"operator"===e.key)||e.find(e=>"producedAt"===e.key||"loggedAt"===e.key||"payoutDate"===e.key||"date"===e.key)||e.find(e=>"status"===e.key))?(0,t.jsx)("td",{className:"px-6 py-4 text-slate-400 text-sm",children:"-"},a.key):(0,t.jsxs)("td",{className:"px-6 py-4 text-slate-900 font-semibold text-sm",children:[new Intl.NumberFormat("ru-RU",{maximumFractionDigits:0}).format(p.count)," ta"]},a.key)),r&&(0,t.jsx)("td",{className:"px-6 py-4"})]})})]})}),y>1&&(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("span",{className:"text-sm text-slate-500",children:["Page ",u," of ",y]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>x(e=>Math.max(1,e-1)),disabled:1===u,className:"px-3 py-1 border border-slate-200 rounded-full text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-50",children:"Previous"}),(0,t.jsx)("button",{onClick:()=>x(e=>Math.min(y,e+1)),disabled:u===y,className:"px-3 py-1 border border-slate-200 rounded-full text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-50",children:"Next"})]})]})]})}e.s(["DataTable",()=>l])},49070,e=>{"use strict";var t=e.i(43476),a=e.i(71645),l=e.i(8623),s=e.i(91288),r=e.i(72161);let i="http://localhost:8080/api";function o(e){if(!e)return;if(e.startsWith("http://")||e.startsWith("https://"))return e;let t="";try{t=new URL(i).origin}catch{t=i.replace(/\/$/,"")}return e.startsWith("/")?`${t}${e}`:`${t}/${e}`}let n=[{key:"order",label:"T/R",sortable:!1},{key:"driver",label:"Haydovchi",sortable:!0},{key:"vehicle",label:"Transport",sortable:!0},{key:"distanceKm",label:"Masofa (km)",sortable:!0},{key:"amount",label:"Yoqilg'i summasi (so'm)",sortable:!0},{key:"date",label:"Sana / vaqt",sortable:!0},{key:"fuelGaugePhoto",label:"Yoqilg'i datchigi",sortable:!1},{key:"speedometerPhoto",label:"Speedometr surati",sortable:!1}],d=new Intl.NumberFormat("ru-RU",{maximumFractionDigits:0}),c=new Date,m=c.getFullYear(),u=`${m}-01-01`,x=c.toISOString().slice(0,10);function h(){let[e,i]=(0,a.useState)({dateFrom:u,dateTo:x,driver:"all",vehicle:"all"}),[c,m]=(0,a.useState)([]),[h,y]=(0,a.useState)(null),[b,p]=(0,a.useState)(!1),[v,f]=(0,a.useState)(null),[g,j]=(0,a.useState)([]),[k,N]=(0,a.useState)([]);(0,a.useEffect)(()=>{let e=!1;return(async()=>{try{let t=await (0,r.get)("/fuel/filters");if(e)return;let a=t&&t.drivers||[],l=t&&t.vehicles||[],s=a.map(e=>{if(null==e||null==e.id)return null;let t=e.name??e.fullName??e.username??("number"==typeof e.id?`ID ${e.id}`:String(e.id));return{id:Number(e.id),label:t}}).filter(e=>null!==e),i=l.map(e=>{if(null==e||null==e.id)return null;let t=e.name??e.label??e.plate??("number"==typeof e.id?`ID ${e.id}`:String(e.id));return{id:Number(e.id),label:t}}).filter(e=>null!==e);j(s),N(i)}catch{e||(j([]),N([]))}})(),()=>{e=!0}},[]),(0,a.useEffect)(()=>{let t=!1;return(async()=>{p(!0),y(null);try{let a=await (0,r.get)("/fuel/events",{params:{dateFrom:e.dateFrom||void 0,dateTo:e.dateTo||void 0,driverId:"all"===e.driver?void 0:Number(e.driver),vehicleId:"all"===e.vehicle?void 0:Number(e.vehicle)}});if(t)return;let l=(Array.isArray(a)?a:a.items??[]).map(e=>{let t=g.find(t=>t.id===e.driverId)?.label??(null!=e.driverId?`ID ${e.driverId}`:"-"),a=null!=e.vehicleId?k.find(t=>t.id===e.vehicleId)?.label??`ID ${e.vehicleId}`:"-",l="",s="",r=e.dateTime??e.createdAt;if(r){let e=new Date(r);Number.isNaN(e.getTime())||(l=e.toISOString().slice(0,10),s=e.toTimeString().slice(0,5))}return{id:String(e.id),driverId:e.driverId,vehicleId:e.vehicleId,driver:t,vehicle:a,date:l,time:s,distanceKm:e.distanceKm??0,amount:e.amount??0,fuelGaugePhoto:o(e.fuelGaugePhotoUrl),speedometerPhoto:o(e.speedometerPhotoUrl)}});m(l)}catch(e){if(t)return;e instanceof r.ApiError?y(e.data&&e.data.message||e.message||"Yoqilg'i yozuvlarini yuklashda xatolik yuz berdi"):y("Yoqilg'i yozuvlarini yuklashda xatolik yuz berdi. Iltimos, qayta urinib ko'ring.")}finally{t||p(!1)}})(),()=>{t=!0}},[e.dateFrom,e.dateTo,e.driver,e.vehicle,g,k]);let w=(0,a.useMemo)(()=>c.filter(t=>{let a,l,s,r="all"===e.driver||null!=t.driverId&&String(t.driverId)===e.driver,i="all"===e.vehicle||null!=t.vehicleId&&String(t.vehicleId)===e.vehicle;return r&&i&&(a=new Date(t.date).getTime(),l=e.dateFrom?new Date(e.dateFrom).getTime():void 0,s=e.dateTo?new Date(e.dateTo).getTime():void 0,("number"!=typeof l||a>=l)&&("number"!=typeof s||a<=s))}).map((e,t)=>({...e,order:t+1})),[c,e.driver,e.vehicle,e.dateFrom,e.dateTo]);return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-semibold text-slate-900",children:"Haydovchilar yoqilg'i sarfi"}),(0,t.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:"Shafyorlar tomonidan kiritilgan yoqilg'i summasi, masofa va chek suratlari bo'yicha hisobot"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl p-6 card-shadow-lg border border-slate-100 space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-semibold text-slate-900 mb-2 block",children:"Boshlanish sanasi"}),(0,t.jsx)("input",{type:"date",value:e.dateFrom,onChange:e=>i(t=>({...t,dateFrom:e.target.value})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2563EB]"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-semibold text-slate-900 mb-2 block",children:"Tugash sanasi"}),(0,t.jsx)("input",{type:"date",value:e.dateTo,onChange:e=>i(t=>({...t,dateTo:e.target.value})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2563EB]"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-semibold text-slate-900 mb-2 block",children:"Haydovchi"}),(0,t.jsxs)("select",{value:e.driver,onChange:e=>i(t=>({...t,driver:e.target.value})),className:"w-full sm-select",children:[(0,t.jsx)("option",{value:"all",children:"Barchasi"}),g.map(e=>(0,t.jsx)("option",{value:String(e.id),children:e.label},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-semibold text-slate-900 mb-2 block",children:"Transport"}),(0,t.jsxs)("select",{value:e.vehicle,onChange:e=>i(t=>({...t,vehicle:e.target.value})),className:"w-full sm-select",children:[(0,t.jsx)("option",{value:"all",children:"Barchasi"}),k.map(e=>(0,t.jsx)("option",{value:String(e.id),children:e.label},e.id))]})]})]}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)("button",{type:"button",onClick:()=>i({dateFrom:"",dateTo:"",driver:"all",vehicle:"all"}),className:"px-4 py-2 border border-slate-200 text-sm text-slate-700 rounded-full bg-white hover:bg-slate-50 mt-2",children:"Filtrlarni tozalash"})})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl p-6 card-shadow-lg border border-slate-100",children:[(0,t.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,t.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Yoqilg'i sarfi jurnali"})}),h&&(0,t.jsx)("p",{className:"mb-4 text-sm text-red-600",children:h}),(0,t.jsx)(l.DataTable,{columns:n,data:w,searchableFields:["driver","vehicle"],renderCell:(e,a)=>"distanceKm"===a.key?`${d.format(e.distanceKm)} km`:"amount"===a.key?`${d.format(e.amount)} so'm`:"date"===a.key?`${e.date} ${e.time}`:"fuelGaugePhoto"===a.key?e.fuelGaugePhoto?(0,t.jsxs)("button",{type:"button",onClick:()=>f({url:e.fuelGaugePhoto,title:"Yoqilg'i datchigi surati"}),className:"flex items-center gap-2 text-[#2563EB] hover:underline text-sm",children:[(0,t.jsx)("img",{src:e.fuelGaugePhoto,alt:"Yoqilg'i datchigi surati",className:"w-12 h-12 rounded-md object-cover border border-slate-200"}),(0,t.jsx)("span",{children:"Ko'rish"})]}):(0,t.jsx)("span",{className:"text-xs text-slate-400",children:"Rasm yo'q"}):"speedometerPhoto"===a.key?e.speedometerPhoto?(0,t.jsxs)("button",{type:"button",onClick:()=>f({url:e.speedometerPhoto,title:"Speedometr surati"}),className:"flex items-center gap-2 text-[#2563EB] hover:underline text-sm",children:[(0,t.jsx)("img",{src:e.speedometerPhoto,alt:"Speedometr surati",className:"w-12 h-12 rounded-md object-cover border border-slate-200"}),(0,t.jsx)("span",{children:"Ko'rish"})]}):(0,t.jsx)("span",{className:"text-xs text-slate-400",children:"Rasm yo'q"}):e[a.key],footerTotals:w.reduce((e,t)=>(e.amount+=t.amount,e.count+=1,e),{amount:0,count:0})})]}),(0,t.jsx)(s.Modal,{isOpen:!!v,title:v?.title??"Rasm",onClose:()=>f(null),size:"lg",children:v&&(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)("img",{src:v.url,alt:v.title,className:"max-h-[80vh] w-auto rounded-xl border border-slate-200"})})})]})}e.s(["default",()=>h])}]);