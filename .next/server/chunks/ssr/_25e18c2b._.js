module.exports=[44499,a=>{"use strict";var b=a.i(87924);let c=(0,a.i(70106).default)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),d={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg"};function e({isOpen:a,title:e,onClose:f,children:g,size:h="md"}){return a?(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4 py-8 bg-slate-950/60 backdrop-blur-sm sm-animate-overlay-in",children:(0,b.jsxs)("div",{className:`w-full ${d[h]} bg-white rounded-2xl border border-slate-200/80 card-shadow-lg overflow-hidden max-h-[90vh] flex flex-col sm-animate-modal-in`,children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-200/80",children:[(0,b.jsx)("h2",{className:"text-base md:text-lg font-semibold text-slate-900",children:e}),(0,b.jsx)("button",{onClick:f,className:"inline-flex h-8 w-8 items-center justify-center rounded-full text-slate-400 hover:text-slate-900 hover:bg-slate-100 transition-colors",children:(0,b.jsx)(c,{className:"w-4 h-4"})})]}),(0,b.jsx)("div",{className:"px-6 py-5 overflow-y-auto",children:g})]})}):null}a.s(["Modal",()=>e],44499)},19941,a=>{"use strict";class b extends Error{status;data;constructor(a,b,c=null){super(a),this.name="ApiError",this.status=b,this.data=c}}async function c(a,d={}){let{method:e="GET",params:f,body:g,headers:h,signal:i}=d,j=function(a,b){let c=a.startsWith("http")?a:`http://localhost:8080/api${a}`;if(!b)return c;let d=new URL(c);return Object.entries(b).forEach(([a,b])=>{null!=b&&d.searchParams.append(a,String(b))}),d.toString()}(a,f),k={"Content-Type":"application/json",...h},l={method:e,headers:k,signal:i};if(null!=g&&"GET"!==e)if(g instanceof FormData){let{"Content-Type":a,...b}=k;l.headers=k=b,l.body=g}else l.body=JSON.stringify(g);let m=await fetch(j,l),n=await m.text(),o=null;if(n)try{o=JSON.parse(n)}catch{o=n}if(!m.ok)throw new b(m.statusText||"Request failed",m.status,o);return o}function d(a,b){return c(a,{...b,method:"GET"})}function e(a,b,d){return c(a,{...d,method:"POST",body:b})}a.s(["ApiError",()=>b,"get",()=>d,"post",()=>e])},15292,a=>{"use strict";var b=a.i(87924),c=a.i(72131);function d({columns:a,data:d,searchableFields:e=[],actions:f,renderCell:g,footerTotals:h}){let[i,j]=(0,c.useState)(""),[k,l]=(0,c.useState)(null),[m,n]=(0,c.useState)(1),o=d;e.length>0&&(o=d.filter(a=>e.some(b=>String(a[b]).toLowerCase().includes(i.toLowerCase())))),k&&(o=[...o].sort((a,b)=>{let c=a[k.key],d=b[k.key],e=c<d?-1:+(c>d);return"asc"===k.direction?e:-e}));let p=Math.ceil(o.length/10),q=o.slice((m-1)*10,10*m),r=h?o.reduce((a,b)=>(void 0!==b.quantity&&(a.quantity+=b.quantity),void 0!==b.totalSum&&(a.totalSum+=b.totalSum),void 0!==b.amount&&(a.amount+=b.amount),void 0!==b.total&&(a.total+=b.total),void 0!==b.advance&&(a.advance+=b.advance),void 0!==b.remaining&&(a.remaining+=b.remaining),void 0!==b.cost&&(a.cost+=b.cost),void 0!==b.count&&(a.count+=b.count),a),{quantity:0,totalSum:0,amount:0,total:0,advance:0,remaining:0,cost:0,count:o.length}):null;return(0,b.jsxs)("div",{className:"space-y-4",children:[e.length>0&&(0,b.jsx)("div",{className:"flex gap-4",children:(0,b.jsx)("input",{type:"text",placeholder:"Search...",value:i,onChange:a=>{j(a.target.value),n(1)},className:"flex-1 px-4 py-2 border border-slate-200 rounded-lg text-sm text-slate-700 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-[#2563EB]"})}),(0,b.jsx)("div",{className:"overflow-x-auto rounded-2xl border border-slate-100",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"bg-slate-50 border-b border-slate-200",children:[a.map(a=>(0,b.jsx)("th",{className:"px-6 py-3 text-left",children:a.sortable?(0,b.jsxs)("button",{onClick:()=>{var b;return b=a.key,void(l(a=>a?.key===b&&"asc"===a.direction?{key:b,direction:"desc"}:{key:b,direction:"asc"}),n(1))},className:"flex items-center gap-2 font-semibold text-slate-700 hover:text-[#2563EB] transition-colors",children:[a.label,k?.key===a.key&&(0,b.jsx)("span",{children:"asc"===k.direction?"↑":"↓"})]}):(0,b.jsx)("span",{className:"font-semibold text-slate-700",children:a.label})},a.key)),f&&(0,b.jsx)("th",{className:"px-6 py-3 text-left font-semibold text-slate-700",children:"Actions"})]})}),(0,b.jsx)("tbody",{children:q.map((c,d)=>(0,b.jsxs)("tr",{className:"border-b border-slate-100 hover:bg-slate-50 transition-colors",children:[a.map(a=>(0,b.jsx)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:g?g(c,a):c[a.key]},a.key)),f&&(0,b.jsx)("td",{className:"px-6 py-4",children:f(c)})]},d))}),r&&(0,b.jsx)("tfoot",{children:(0,b.jsxs)("tr",{className:"bg-slate-50 border-t border-slate-200 font-semibold",children:[a.map(c=>"quantity"===c.key&&void 0!==r.quantity?(0,b.jsxs)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:[new Intl.NumberFormat("ru-RU",{maximumFractionDigits:0}).format(r.quantity)," tonna"]},c.key):"cost"===c.key&&void 0!==r.cost?(0,b.jsx)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:new Intl.NumberFormat("ru-RU",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(r.cost)},c.key):"totalSum"===c.key&&void 0!==r.totalSum?(0,b.jsxs)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:[new Intl.NumberFormat("ru-RU",{maximumFractionDigits:0}).format(r.totalSum)," so'm"]},c.key):"amount"===c.key&&void 0!==r.amount?(0,b.jsx)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:new Intl.NumberFormat("ru-RU",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(r.amount)},c.key):"total"===c.key&&void 0!==r.total?(0,b.jsx)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:new Intl.NumberFormat("ru-RU",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(r.total)},c.key):"advance"===c.key&&void 0!==r.advance?(0,b.jsx)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:new Intl.NumberFormat("ru-RU",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(r.advance)},c.key):"remaining"===c.key&&void 0!==r.remaining?(0,b.jsx)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:new Intl.NumberFormat("ru-RU",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(r.remaining)},c.key):"batchId"===c.key||"id"===c.key?(0,b.jsx)("td",{className:"px-6 py-4 text-slate-900 text-right font-semibold text-sm",children:"Jami:"},c.key):("operator"!==c.key||void 0===r.count||!(r.count>0))&&("producedAt"!==c.key&&"loggedAt"!==c.key&&"payoutDate"!==c.key&&"date"!==c.key||void 0===r.count||!(r.count>0)||a.find(a=>"operator"===a.key))&&("status"!==c.key||void 0===r.count||!(r.count>0)||a.find(a=>"operator"===a.key)||a.find(a=>"producedAt"===a.key||"loggedAt"===a.key||"payoutDate"===a.key||"date"===a.key))&&("transport"!==c.key||void 0===r.count||!(r.count>0)||a.find(a=>"operator"===a.key)||a.find(a=>"producedAt"===a.key||"loggedAt"===a.key||"payoutDate"===a.key||"date"===a.key)||a.find(a=>"status"===a.key))?(0,b.jsx)("td",{className:"px-6 py-4 text-slate-400 text-sm",children:"-"},c.key):(0,b.jsxs)("td",{className:"px-6 py-4 text-slate-900 font-semibold text-sm",children:[new Intl.NumberFormat("ru-RU",{maximumFractionDigits:0}).format(r.count)," ta"]},c.key)),f&&(0,b.jsx)("td",{className:"px-6 py-4"})]})})]})}),p>1&&(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsxs)("span",{className:"text-sm text-slate-500",children:["Page ",m," of ",p]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:()=>n(a=>Math.max(1,a-1)),disabled:1===m,className:"px-3 py-1 border border-slate-200 rounded-full text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-50",children:"Previous"}),(0,b.jsx)("button",{onClick:()=>n(a=>Math.min(p,a+1)),disabled:m===p,className:"px-3 py-1 border border-slate-200 rounded-full text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-50",children:"Next"})]})]})]})}a.s(["DataTable",()=>d])},62427,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(15292),e=a.i(44499),f=a.i(19941);let g=new Date,h=g.getFullYear(),i=`${h}-01-01`,j=g.toISOString().split("T")[0],k=[{key:"id",label:"Hujjat",sortable:!0},{key:"title",label:"Tavsif",sortable:!1},{key:"category",label:"Kategoriya",sortable:!0},{key:"department",label:"Bo'lim",sortable:!0},{key:"amount",label:"Miqdor ($)",sortable:!0},{key:"date",label:"Sana",sortable:!0}],l=new Intl.NumberFormat("ru-RU",{style:"currency",currency:"USD",maximumFractionDigits:0});function m(){let[a,g]=(0,c.useState)({dateFrom:i,dateTo:j,category:"all",status:"all"}),[h,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)({title:"",category:"Energiya",department:"Ishlab chiqarish",amount:"",status:"Tasdiq kutmoqda",date:new Date().toISOString().split("T")[0],employeeName:""}),[p,q]=(0,c.useState)([]),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)([]),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(null);(0,c.useEffect)(()=>{let b=!1;return(async()=>{u(!0),s(null);try{let c=await (0,f.get)("/expenses",{params:{dateFrom:a.dateFrom||void 0,dateTo:a.dateTo||void 0,category:"all"===a.category?void 0:a.category}});if(b)return;let d=Array.isArray(c)?c:c.items??[];q(d)}catch(a){if(b)return;a instanceof f.ApiError?s(a.data&&a.data.message||a.message||"Rasxodlar ro'yxatini yuklashda xatolik yuz berdi"):s("Rasxodlar ro'yxatini yuklashda xatolik yuz berdi. Iltimos, qayta urinib ko'ring.")}finally{b||u(!1)}})(),()=>{b=!0}},[a.dateFrom,a.dateTo,a.category]),(0,c.useEffect)(()=>{if(!h||"Ish haqi"!==n.category||D||B)return;let a=!1;return(async()=>{C(!0),G(null);try{let b=await (0,f.get)("/employees",{params:{department:"",role:"",active:!0}});if(a)return;let c=Array.isArray(b)?b:b.items??[];A(c),E(!0)}catch(b){if(a)return;b instanceof f.ApiError?G(b.data&&b.data.message||b.message||"Xodimlar ro'yxatini yuklashda xatolik yuz berdi"):G("Xodimlar ro'yxatini yuklashda xatolik yuz berdi. Iltimos, qayta urinib ko'ring.")}finally{a||C(!1)}})(),()=>{a=!0}},[h,n.category,D,B]);let J=(0,c.useMemo)(()=>p.filter(b=>{let c,d,e,f="all"===a.category||b.category===a.category,g="all"===a.status||!a.status||b.status===a.status;return f&&g&&(c=new Date(b.date).getTime(),d=a.dateFrom?new Date(a.dateFrom).getTime():void 0,e=a.dateTo?new Date(a.dateTo).getTime():void 0,("number"!=typeof d||c>=d)&&("number"!=typeof e||c<=e))}),[p,a.category,a.status,a.dateFrom,a.dateTo]),K=J.reduce((a,b)=>(a.total+=b.amount,a.count+=1,a.byCategory[b.category]||(a.byCategory[b.category]=0),a.byCategory[b.category]+=b.amount,a),{total:0,count:0,byCategory:{}});return Object.entries(K.byCategory).sort((a,b)=>b[1]-a[1])[0]?.[0],(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-[#0F172A]",children:"Umumiy rasxodlar"}),(0,b.jsx)("p",{className:"text-[#64748B] mt-1",children:"Energiya, logistika, texnik xizmat va ish haqi bo'yicha to'liq hisobot"})]}),(0,b.jsx)("div",{className:"bg-white rounded-lg p-6 card-shadow space-y-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-semibold text-[#0F172A] mb-2 block",children:"Boshlanish sanasi"}),(0,b.jsx)("input",{type:"date",value:a.dateFrom,onChange:a=>g(b=>({...b,dateFrom:a.target.value})),className:"w-full px-3 py-2 border border-[#E2E8F0] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2563EB]"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-semibold text-[#0F172A] mb-2 block",children:"Tugash sanasi"}),(0,b.jsx)("input",{type:"date",value:a.dateTo,onChange:a=>g(b=>({...b,dateTo:a.target.value})),className:"w-full px-3 py-2 border border-[#E2E8F0] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2563EB]"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-semibold text-[#0F172A] mb-2 block",children:"Kategoriya"}),(0,b.jsxs)("select",{value:a.category,onChange:a=>g(b=>({...b,category:a.target.value})),className:"w-full sm-select",children:[(0,b.jsx)("option",{value:"all",children:"Barchasi"}),(0,b.jsx)("option",{value:"Energiya",children:"Energiya"}),(0,b.jsx)("option",{value:"Logistika",children:"Logistika"}),(0,b.jsx)("option",{value:"Texnik",children:"Texnik"}),(0,b.jsx)("option",{value:"Ish haqi",children:"Ish haqi"})]})]}),(0,b.jsx)("div",{className:"flex items-end",children:(0,b.jsx)("button",{type:"button",onClick:()=>g({dateFrom:"",dateTo:"",category:"all",status:"all"}),className:"w-full px-3 py-2 border border-[#E2E8F0] rounded-lg text-sm text-[#0F172A] hover:bg-[#F1F5F9]",children:"Filtrlarni tozalash"})})]})}),(0,b.jsxs)("div",{className:"bg-white rounded-lg p-6 card-shadow",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-[#0F172A]",children:"Rasxodlar jurnali"}),(0,b.jsxs)("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-[#2563EB] text-white rounded-lg hover:bg-[#1D4ED8] transition-colors font-semibold flex items-center gap-2",children:[(0,b.jsx)("span",{children:"+"}),(0,b.jsx)("span",{children:"Yangi rasxod"})]})]}),r&&(0,b.jsx)("p",{className:"mb-4 text-sm text-red-600",children:r}),t&&!r&&(0,b.jsx)("p",{className:"mb-4 text-sm text-[#64748B]",children:"Yuklanmoqda..."}),(0,b.jsx)(d.DataTable,{columns:k,data:J,searchableFields:["id","title","category","department"],renderCell:(a,b)=>"amount"===b.key?l.format(a[b.key]):a[b.key],footerTotals:J.reduce((a,b)=>(a.amount+=b.amount,a.count+=1,a),{amount:0,count:0})})]}),(0,b.jsx)(e.Modal,{isOpen:h,title:"Yangi rasxod kiritish",onClose:()=>{m(!1),o({title:"",category:"Energiya",department:"Ishlab chiqarish",amount:"",status:"Tasdiq kutmoqda",date:new Date().toISOString().split("T")[0],employeeName:""}),w(null),I(null),y(!1)},size:"lg",children:(0,b.jsxs)("form",{onSubmit:async a=>{if(a.preventDefault(),y(!0),w(null),"Ish haqi"===n.category&&!n.employeeName){I("Xodim majburiy"),y(!1);return}try{let a={title:n.title,category:n.category,department:n.department,employeeName:"Ish haqi"===n.category?n.employeeName:void 0,amount:Number(n.amount)||0,currency:"USD",date:n.date,status:n.status},b=await (0,f.post)("/expenses",a),c=b.expense??b;q(a=>[...a,c]),m(!1),o({title:"",category:"Energiya",department:"Ishlab chiqarish",amount:"",status:"Tasdiq kutmoqda",date:new Date().toISOString().split("T")[0],employeeName:""}),I(null)}catch(a){a instanceof f.ApiError?w(a.data&&a.data.message||a.message||"Yangi rasxodni saqlashda xatolik yuz berdi"):w("Yangi rasxodni saqlashda xatolik yuz berdi. Iltimos, qayta urinib ko'ring.")}finally{y(!1)}},className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-semibold text-[#0F172A] mb-2 block",children:"Tavsif"}),(0,b.jsx)("input",{type:"text",value:n.title,onChange:a=>o(b=>({...b,title:a.target.value})),className:"w-full px-3 py-2 border border-[#E2E8F0] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2563EB]",placeholder:"Masalan: Elektr energiyasi",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-semibold text-[#0F172A] mb-2 block",children:"Kategoriya"}),(0,b.jsxs)("select",{value:n.category,onChange:a=>{let b=a.target.value;o(a=>({...a,category:b,employeeName:"Ish haqi"===b?a.employeeName:""})),I(null)},className:"w-full sm-select",required:!0,children:[(0,b.jsx)("option",{value:"Energiya",children:"Energiya"}),(0,b.jsx)("option",{value:"Logistika",children:"Logistika"}),(0,b.jsx)("option",{value:"Texnik",children:"Texnik"}),(0,b.jsx)("option",{value:"Ish haqi",children:"Ish haqi"}),(0,b.jsx)("option",{value:"Boshqa",children:"Boshqa"})]})]}),"Ish haqi"===n.category&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-semibold text-[#0F172A] mb-2 block",children:"Xodim"}),(0,b.jsxs)("select",{value:n.employeeName,onChange:a=>{let b=a.target.value;I(null);let c=z.find(a=>a.fullName===b);o(a=>({...a,employeeName:b,department:c?.department||a.department}))},className:"w-full sm-select",required:!0,children:[(0,b.jsx)("option",{value:"",disabled:!0,children:"Xodim tanlang"}),z.map(a=>(0,b.jsx)("option",{value:a.fullName,children:a.fullName},a.id))]}),H&&(0,b.jsx)("p",{className:"mt-1 text-xs text-red-600",children:H}),F&&(0,b.jsx)("p",{className:"mt-1 text-xs text-red-600",children:F})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-semibold text-[#0F172A] mb-2 block",children:"Miqdor ($)"}),(0,b.jsx)("input",{type:"number",value:n.amount,onChange:a=>o(b=>({...b,amount:a.target.value})),className:"w-full px-3 py-2 border border-[#E2E8F0] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2563EB]",placeholder:"0",min:"0",step:"0.01",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-semibold text-[#0F172A] mb-2 block",children:"Sana"}),(0,b.jsx)("input",{type:"date",value:n.date,onChange:a=>o(b=>({...b,date:a.target.value})),className:"w-full px-3 py-2 border border-[#E2E8F0] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2563EB]",required:!0})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,b.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-[#2563EB] text-white rounded-lg hover:bg-[#1D4ED8] transition-colors font-semibold disabled:opacity-50 disabled:cursor-not-allowed",disabled:x,children:"Saqlash"}),(0,b.jsx)("button",{type:"button",onClick:()=>{m(!1),o({title:"",category:"Energiya",department:"Ishlab chiqarish",amount:"",status:"Tasdiq kutmoqda",date:new Date().toISOString().split("T")[0],employeeName:""}),w(null),I(null)},className:"flex-1 px-4 py-2 bg-gray-200 text-[#0F172A] rounded-lg hover:bg-gray-300 transition-colors font-semibold",children:"Bekor qilish"})]}),v&&(0,b.jsx)("p",{className:"text-sm text-red-600",children:v})]})})]})}a.s(["default",()=>m])}];

//# sourceMappingURL=_25e18c2b._.js.map