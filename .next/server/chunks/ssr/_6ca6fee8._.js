module.exports=[44499,a=>{"use strict";var b=a.i(87924);let c=(0,a.i(70106).default)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),d={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg"};function e({isOpen:a,title:e,onClose:f,children:g,size:h="md"}){return a?(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4 py-8 bg-slate-950/60 backdrop-blur-sm sm-animate-overlay-in",children:(0,b.jsxs)("div",{className:`w-full ${d[h]} bg-white rounded-2xl border border-slate-200/80 card-shadow-lg overflow-hidden max-h-[90vh] flex flex-col sm-animate-modal-in`,children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-200/80",children:[(0,b.jsx)("h2",{className:"text-base md:text-lg font-semibold text-slate-900",children:e}),(0,b.jsx)("button",{onClick:f,className:"inline-flex h-8 w-8 items-center justify-center rounded-full text-slate-400 hover:text-slate-900 hover:bg-slate-100 transition-colors",children:(0,b.jsx)(c,{className:"w-4 h-4"})})]}),(0,b.jsx)("div",{className:"px-6 py-5 overflow-y-auto",children:g})]})}):null}a.s(["Modal",()=>e],44499)},19941,a=>{"use strict";class b extends Error{status;data;constructor(a,b,c=null){super(a),this.name="ApiError",this.status=b,this.data=c}}async function c(a,d={}){let{method:e="GET",params:f,body:g,headers:h,signal:i}=d,j=function(a,b){let c=a.startsWith("http")?a:`http://localhost:8080/api${a}`;if(!b)return c;let d=new URL(c);return Object.entries(b).forEach(([a,b])=>{null!=b&&d.searchParams.append(a,String(b))}),d.toString()}(a,f),k={"Content-Type":"application/json",...h},l={method:e,headers:k,signal:i};if(null!=g&&"GET"!==e)if(g instanceof FormData){let{"Content-Type":a,...b}=k;l.headers=k=b,l.body=g}else l.body=JSON.stringify(g);let m=await fetch(j,l),n=await m.text(),o=null;if(n)try{o=JSON.parse(n)}catch{o=n}if(!m.ok)throw new b(m.statusText||"Request failed",m.status,o);return o}function d(a,b){return c(a,{...b,method:"GET"})}function e(a,b,d){return c(a,{...d,method:"POST",body:b})}a.s(["ApiError",()=>b,"get",()=>d,"post",()=>e])},15292,a=>{"use strict";var b=a.i(87924),c=a.i(72131);function d({columns:a,data:d,searchableFields:e=[],actions:f,renderCell:g,footerTotals:h}){let[i,j]=(0,c.useState)(""),[k,l]=(0,c.useState)(null),[m,n]=(0,c.useState)(1),o=d;e.length>0&&(o=d.filter(a=>e.some(b=>String(a[b]).toLowerCase().includes(i.toLowerCase())))),k&&(o=[...o].sort((a,b)=>{let c=a[k.key],d=b[k.key],e=c<d?-1:+(c>d);return"asc"===k.direction?e:-e}));let p=Math.ceil(o.length/10),q=o.slice((m-1)*10,10*m),r=h?o.reduce((a,b)=>(void 0!==b.quantity&&(a.quantity+=b.quantity),void 0!==b.totalSum&&(a.totalSum+=b.totalSum),void 0!==b.amount&&(a.amount+=b.amount),void 0!==b.total&&(a.total+=b.total),void 0!==b.advance&&(a.advance+=b.advance),void 0!==b.remaining&&(a.remaining+=b.remaining),void 0!==b.cost&&(a.cost+=b.cost),void 0!==b.count&&(a.count+=b.count),a),{quantity:0,totalSum:0,amount:0,total:0,advance:0,remaining:0,cost:0,count:o.length}):null;return(0,b.jsxs)("div",{className:"space-y-4",children:[e.length>0&&(0,b.jsx)("div",{className:"flex gap-4",children:(0,b.jsx)("input",{type:"text",placeholder:"Search...",value:i,onChange:a=>{j(a.target.value),n(1)},className:"flex-1 px-4 py-2 border border-slate-200 rounded-lg text-sm text-slate-700 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-[#2563EB]"})}),(0,b.jsx)("div",{className:"overflow-x-auto rounded-2xl border border-slate-100",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"bg-slate-50 border-b border-slate-200",children:[a.map(a=>(0,b.jsx)("th",{className:"px-6 py-3 text-left",children:a.sortable?(0,b.jsxs)("button",{onClick:()=>{var b;return b=a.key,void(l(a=>a?.key===b&&"asc"===a.direction?{key:b,direction:"desc"}:{key:b,direction:"asc"}),n(1))},className:"flex items-center gap-2 font-semibold text-slate-700 hover:text-[#2563EB] transition-colors",children:[a.label,k?.key===a.key&&(0,b.jsx)("span",{children:"asc"===k.direction?"↑":"↓"})]}):(0,b.jsx)("span",{className:"font-semibold text-slate-700",children:a.label})},a.key)),f&&(0,b.jsx)("th",{className:"px-6 py-3 text-left font-semibold text-slate-700",children:"Actions"})]})}),(0,b.jsx)("tbody",{children:q.map((c,d)=>(0,b.jsxs)("tr",{className:"border-b border-slate-100 hover:bg-slate-50 transition-colors",children:[a.map(a=>(0,b.jsx)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:g?g(c,a):c[a.key]},a.key)),f&&(0,b.jsx)("td",{className:"px-6 py-4",children:f(c)})]},d))}),r&&(0,b.jsx)("tfoot",{children:(0,b.jsxs)("tr",{className:"bg-slate-50 border-t border-slate-200 font-semibold",children:[a.map(c=>"quantity"===c.key&&void 0!==r.quantity?(0,b.jsxs)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:[new Intl.NumberFormat("ru-RU",{maximumFractionDigits:0}).format(r.quantity)," tonna"]},c.key):"cost"===c.key&&void 0!==r.cost?(0,b.jsx)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:new Intl.NumberFormat("ru-RU",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(r.cost)},c.key):"totalSum"===c.key&&void 0!==r.totalSum?(0,b.jsxs)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:[new Intl.NumberFormat("ru-RU",{maximumFractionDigits:0}).format(r.totalSum)," so'm"]},c.key):"amount"===c.key&&void 0!==r.amount?(0,b.jsx)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:new Intl.NumberFormat("ru-RU",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(r.amount)},c.key):"total"===c.key&&void 0!==r.total?(0,b.jsx)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:new Intl.NumberFormat("ru-RU",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(r.total)},c.key):"advance"===c.key&&void 0!==r.advance?(0,b.jsx)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:new Intl.NumberFormat("ru-RU",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(r.advance)},c.key):"remaining"===c.key&&void 0!==r.remaining?(0,b.jsx)("td",{className:"px-6 py-4 text-slate-900 text-sm",children:new Intl.NumberFormat("ru-RU",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(r.remaining)},c.key):"batchId"===c.key||"id"===c.key?(0,b.jsx)("td",{className:"px-6 py-4 text-slate-900 text-right font-semibold text-sm",children:"Jami:"},c.key):("operator"!==c.key||void 0===r.count||!(r.count>0))&&("producedAt"!==c.key&&"loggedAt"!==c.key&&"payoutDate"!==c.key&&"date"!==c.key||void 0===r.count||!(r.count>0)||a.find(a=>"operator"===a.key))&&("status"!==c.key||void 0===r.count||!(r.count>0)||a.find(a=>"operator"===a.key)||a.find(a=>"producedAt"===a.key||"loggedAt"===a.key||"payoutDate"===a.key||"date"===a.key))&&("transport"!==c.key||void 0===r.count||!(r.count>0)||a.find(a=>"operator"===a.key)||a.find(a=>"producedAt"===a.key||"loggedAt"===a.key||"payoutDate"===a.key||"date"===a.key)||a.find(a=>"status"===a.key))?(0,b.jsx)("td",{className:"px-6 py-4 text-slate-400 text-sm",children:"-"},c.key):(0,b.jsxs)("td",{className:"px-6 py-4 text-slate-900 font-semibold text-sm",children:[new Intl.NumberFormat("ru-RU",{maximumFractionDigits:0}).format(r.count)," ta"]},c.key)),f&&(0,b.jsx)("td",{className:"px-6 py-4"})]})})]})}),p>1&&(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsxs)("span",{className:"text-sm text-slate-500",children:["Page ",m," of ",p]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:()=>n(a=>Math.max(1,a-1)),disabled:1===m,className:"px-3 py-1 border border-slate-200 rounded-full text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-50",children:"Previous"}),(0,b.jsx)("button",{onClick:()=>n(a=>Math.min(p,a+1)),disabled:m===p,className:"px-3 py-1 border border-slate-200 rounded-full text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-50",children:"Next"})]})]})]})}a.s(["DataTable",()=>d])},43259,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(15292),e=a.i(44499),f=a.i(19941);let g="http://localhost:8080/api";function h(a){if(!a)return;if(a.startsWith("http://")||a.startsWith("https://"))return a;let b="";try{b=new URL(g).origin}catch{b=g.replace(/\/$/,"")}return a.startsWith("/")?`${b}${a}`:`${b}/${a}`}let i=[{key:"order",label:"T/R",sortable:!1},{key:"driver",label:"Haydovchi",sortable:!0},{key:"vehicle",label:"Transport",sortable:!0},{key:"distanceKm",label:"Masofa (km)",sortable:!0},{key:"amount",label:"Yoqilg'i summasi (so'm)",sortable:!0},{key:"date",label:"Sana / vaqt",sortable:!0},{key:"fuelGaugePhoto",label:"Yoqilg'i datchigi",sortable:!1},{key:"speedometerPhoto",label:"Speedometr surati",sortable:!1}],j=new Intl.NumberFormat("ru-RU",{maximumFractionDigits:0}),k=new Date,l=k.getFullYear(),m=`${l}-01-01`,n=k.toISOString().slice(0,10);function o(){let[a,g]=(0,c.useState)({dateFrom:m,dateTo:n,driver:"all",vehicle:"all"}),[k,l]=(0,c.useState)([]),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)([]),[w,x]=(0,c.useState)([]);(0,c.useEffect)(()=>{let a=!1;return(async()=>{try{let b=await (0,f.get)("/fuel/filters");if(a)return;let c=b&&b.drivers||[],d=b&&b.vehicles||[],e=c.map(a=>{if(null==a||null==a.id)return null;let b=a.name??a.fullName??a.username??("number"==typeof a.id?`ID ${a.id}`:String(a.id));return{id:Number(a.id),label:b}}).filter(a=>null!==a),g=d.map(a=>{if(null==a||null==a.id)return null;let b=a.name??a.label??a.plate??("number"==typeof a.id?`ID ${a.id}`:String(a.id));return{id:Number(a.id),label:b}}).filter(a=>null!==a);v(e),x(g)}catch{a||(v([]),x([]))}})(),()=>{a=!0}},[]),(0,c.useEffect)(()=>{let b=!1;return(async()=>{r(!0),p(null);try{let c=await (0,f.get)("/fuel/events",{params:{dateFrom:a.dateFrom||void 0,dateTo:a.dateTo||void 0,driverId:"all"===a.driver?void 0:Number(a.driver),vehicleId:"all"===a.vehicle?void 0:Number(a.vehicle)}});if(b)return;let d=(Array.isArray(c)?c:c.items??[]).map(a=>{let b=u.find(b=>b.id===a.driverId)?.label??(null!=a.driverId?`ID ${a.driverId}`:"-"),c=null!=a.vehicleId?w.find(b=>b.id===a.vehicleId)?.label??`ID ${a.vehicleId}`:"-",d="",e="",f=a.dateTime??a.createdAt;if(f){let a=new Date(f);Number.isNaN(a.getTime())||(d=a.toISOString().slice(0,10),e=a.toTimeString().slice(0,5))}return{id:String(a.id),driverId:a.driverId,vehicleId:a.vehicleId,driver:b,vehicle:c,date:d,time:e,distanceKm:a.distanceKm??0,amount:a.amount??0,fuelGaugePhoto:h(a.fuelGaugePhotoUrl),speedometerPhoto:h(a.speedometerPhotoUrl)}});l(d)}catch(a){if(b)return;a instanceof f.ApiError?p(a.data&&a.data.message||a.message||"Yoqilg'i yozuvlarini yuklashda xatolik yuz berdi"):p("Yoqilg'i yozuvlarini yuklashda xatolik yuz berdi. Iltimos, qayta urinib ko'ring.")}finally{b||r(!1)}})(),()=>{b=!0}},[a.dateFrom,a.dateTo,a.driver,a.vehicle,u,w]);let y=(0,c.useMemo)(()=>k.filter(b=>{let c,d,e,f="all"===a.driver||null!=b.driverId&&String(b.driverId)===a.driver,g="all"===a.vehicle||null!=b.vehicleId&&String(b.vehicleId)===a.vehicle;return f&&g&&(c=new Date(b.date).getTime(),d=a.dateFrom?new Date(a.dateFrom).getTime():void 0,e=a.dateTo?new Date(a.dateTo).getTime():void 0,("number"!=typeof d||c>=d)&&("number"!=typeof e||c<=e))}).map((a,b)=>({...a,order:b+1})),[k,a.driver,a.vehicle,a.dateFrom,a.dateTo]);return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-semibold text-slate-900",children:"Haydovchilar yoqilg'i sarfi"}),(0,b.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:"Shafyorlar tomonidan kiritilgan yoqilg'i summasi, masofa va chek suratlari bo'yicha hisobot"})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl p-6 card-shadow-lg border border-slate-100 space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-semibold text-slate-900 mb-2 block",children:"Boshlanish sanasi"}),(0,b.jsx)("input",{type:"date",value:a.dateFrom,onChange:a=>g(b=>({...b,dateFrom:a.target.value})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2563EB]"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-semibold text-slate-900 mb-2 block",children:"Tugash sanasi"}),(0,b.jsx)("input",{type:"date",value:a.dateTo,onChange:a=>g(b=>({...b,dateTo:a.target.value})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2563EB]"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-semibold text-slate-900 mb-2 block",children:"Haydovchi"}),(0,b.jsxs)("select",{value:a.driver,onChange:a=>g(b=>({...b,driver:a.target.value})),className:"w-full sm-select",children:[(0,b.jsx)("option",{value:"all",children:"Barchasi"}),u.map(a=>(0,b.jsx)("option",{value:String(a.id),children:a.label},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-semibold text-slate-900 mb-2 block",children:"Transport"}),(0,b.jsxs)("select",{value:a.vehicle,onChange:a=>g(b=>({...b,vehicle:a.target.value})),className:"w-full sm-select",children:[(0,b.jsx)("option",{value:"all",children:"Barchasi"}),w.map(a=>(0,b.jsx)("option",{value:String(a.id),children:a.label},a.id))]})]})]}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsx)("button",{type:"button",onClick:()=>g({dateFrom:"",dateTo:"",driver:"all",vehicle:"all"}),className:"px-4 py-2 border border-slate-200 text-sm text-slate-700 rounded-full bg-white hover:bg-slate-50 mt-2",children:"Filtrlarni tozalash"})})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl p-6 card-shadow-lg border border-slate-100",children:[(0,b.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,b.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Yoqilg'i sarfi jurnali"})}),o&&(0,b.jsx)("p",{className:"mb-4 text-sm text-red-600",children:o}),(0,b.jsx)(d.DataTable,{columns:i,data:y,searchableFields:["driver","vehicle"],renderCell:(a,c)=>"distanceKm"===c.key?`${j.format(a.distanceKm)} km`:"amount"===c.key?`${j.format(a.amount)} so'm`:"date"===c.key?`${a.date} ${a.time}`:"fuelGaugePhoto"===c.key?a.fuelGaugePhoto?(0,b.jsxs)("button",{type:"button",onClick:()=>t({url:a.fuelGaugePhoto,title:"Yoqilg'i datchigi surati"}),className:"flex items-center gap-2 text-[#2563EB] hover:underline text-sm",children:[(0,b.jsx)("img",{src:a.fuelGaugePhoto,alt:"Yoqilg'i datchigi surati",className:"w-12 h-12 rounded-md object-cover border border-slate-200"}),(0,b.jsx)("span",{children:"Ko'rish"})]}):(0,b.jsx)("span",{className:"text-xs text-slate-400",children:"Rasm yo'q"}):"speedometerPhoto"===c.key?a.speedometerPhoto?(0,b.jsxs)("button",{type:"button",onClick:()=>t({url:a.speedometerPhoto,title:"Speedometr surati"}),className:"flex items-center gap-2 text-[#2563EB] hover:underline text-sm",children:[(0,b.jsx)("img",{src:a.speedometerPhoto,alt:"Speedometr surati",className:"w-12 h-12 rounded-md object-cover border border-slate-200"}),(0,b.jsx)("span",{children:"Ko'rish"})]}):(0,b.jsx)("span",{className:"text-xs text-slate-400",children:"Rasm yo'q"}):a[c.key],footerTotals:y.reduce((a,b)=>(a.amount+=b.amount,a.count+=1,a),{amount:0,count:0})})]}),(0,b.jsx)(e.Modal,{isOpen:!!s,title:s?.title??"Rasm",onClose:()=>t(null),size:"lg",children:s&&(0,b.jsx)("div",{className:"flex justify-center",children:(0,b.jsx)("img",{src:s.url,alt:s.title,className:"max-h-[80vh] w-auto rounded-xl border border-slate-200"})})})]})}a.s(["default",()=>o])}];

//# sourceMappingURL=_6ca6fee8._.js.map